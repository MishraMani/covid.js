var indiaMapSvg,worldMapSvg,statewiseJson={},total={},indiaTotal={},box=document.querySelector("#tabContent .states-list");function scrollToElm(t,e,a){scrollTo(t,getRelativePos(e).top,a)}function getRelativePos(t){var e=t.parentNode.getBoundingClientRect(),a=t.getBoundingClientRect(),o={};return o.top=a.top-e.top+t.parentNode.scrollTop,o.right=a.right-e.right,o.bottom=a.bottom-e.bottom,o.left=a.left-e.left,o}function scrollTo(t,e,a,o){var n,r,i=t.scrollTop,s=e-i,d=performance.now();!function e(){n=performance.now(),r=(n-d)/1e3/a,t.scrollTop=i+s*easeInOutQuad(r),r<1?window.requestAnimationFrame(e):o&&o()}()}function easeInOutQuad(t){return t<.5?2*t*t:(4-2*t)*t-1}function getMax(t,e){for(var a,o=0;o<t.length;o++)"Total"!=t[o].state&&(null==a||parseInt(t[o][e])>parseInt(a[e]))&&(a=t[o]);return a}function fillSvg(t){var e=getMax(t.statewise,"confirmed").confirmed.toString(10),a=Math.ceil(e/Math.pow(10,e.length-2))*Math.pow(10,e.length-2);document.querySelectorAll("#mapSvg path").forEach(t=>{var e=t.getAttribute("title"),o=((statewiseJson[e]?statewiseJson[e]:0).confirmed/a).toFixed(2);o=Math.max(.05,o),t.style.fill="rgba(255,0,0,"+o+")"});for(var o=document.getElementById("legendPoints"),n=0,r=a/4,i="";n<a;)i+=`<div class="point">${n}</div>`,n=Math.ceil(n+r);i+=`<span>${a}</span>`,o.innerHTML=i}function tableData(t){html="",t.forEach(t=>{"Total"!=t.state&&(html+=`<tr title="${t.state.toLowerCase()}"><td>${t.state.toLowerCase()}</td><td>${t.confirmed}</td><td>${t.recovered}</td><td>${t.deaths}</td></tr>`)}),document.getElementById("states").innerHTML=html,highlightMap()}function highlightMap(){var t=document.querySelectorAll("#states tr"),e=document.querySelectorAll("#mapSvg path");new Set([...t,...e]).forEach(t=>{var e,a="";t.addEventListener("mouseover",()=>{a=t.getAttribute("title").toLowerCase(),mapQuery="path"==t.nodeName?`#states [title="${a}"]`:`#mapSvg [title="${a}"]`,t.classList.add("hover"),e=document.querySelector(mapQuery),updatePopup(statewiseJson[a]),e&&(e.classList.add("hover"),"path"==t.nodeName&&scrollToElm(box,e,.5))}),t.addEventListener("mouseout",()=>{e&&e.classList.remove("hover"),t.classList.remove("hover"),updatePopup(total)})})}function updatePopup(t){if(t){var e=document.querySelector("#stateName"),a=document.querySelector("#confirmed"),o=document.querySelector("#active"),n=document.querySelector("#deaths");e.innerHTML=t.state,a.innerHTML=t.confirmed,o.innerHTML=t.recovered,n.innerHTML=t.deaths}}function getCoronaData(t,e){fetch(t).then((function(t){return t.json()})).then((function(t){document.getElementById("swgWrapper").innerHTML=currentMapSvg;var a=document.querySelectorAll("#mapSvg path");for(const t of a)t.setAttribute("title",t.getAttribute("title").toLowerCase());statewiseJson={};for(const[e,a]of[...t.statewise].entries()){"US"==a.state&&(t.statewise[e].state="United States"),"India"==a.state&&(t.statewise[e]=indiaTotal);const o=a.state;statewiseJson[o.toLowerCase()]=a}total={confirmed:t.totalConfirmed?t.totalConfirmed:"-",recovered:t.totalRecovered?t.totalRecovered:"-",deaths:t.totalDeaths?t.totalDeaths:"-",state:"Total"},fillSvg(t),tableData(t.statewise),"indiaBtn"==e?(document.getElementById("indiaBtn").classList.add("active"),document.getElementById("worldBtn").classList.remove("active"),document.getElementById("tabContent").classList.remove("worldMap"),document.getElementById("dataSource").innerText="Datasource - Ministry of Health & Family Welfare, India. Designed By : Mani Mishra https://www.facebook.com/official.manimishra",total.state="India",indiaTotal=total):(document.getElementById("worldBtn").classList.add("active"),document.getElementById("indiaBtn").classList.remove("active"),document.getElementById("tabContent").classList.add("worldMap"),document.getElementById("dataSource").innerText="Datasource - Johns Hopkins University,U.S",total.state="World"),updatePopup(total),document.getElementById("loader-wrapper").classList.add("hide")})).catch((function(t){console.log(t)}))}function getMap(t,e,a){document.getElementById("loader-wrapper").classList.remove("hide"),"indiaBtn"==a&&indiaMapSvg?(currentMapSvg=indiaMapSvg,getCoronaData(e,a)):"worldBtn"==a&&worldMapSvg?(currentMapSvg=worldMapSvg,getCoronaData(e,a)):fetch(t).then(t=>t.text()).then(t=>{currentMapSvg="indiaBtn"==a?indiaMapSvg=t:worldMapSvg=t,getCoronaData(e,a)}).catch((function(t){console.log(t)}))}function getIndiaData(){var t=new Date;getMap("https://cdn.abplive.com/covid19-map/svg/india2.svg","https://cdn.abplive.com/coronastats/prod/coronastats-new.json?ts="+(t=t.getTime()),"indiaBtn")}function getWorldData(){var t=new Date;getMap("https://cdn.abplive.com/covid19-map/svg/world2.svg","https://cdn.abplive.com/coronastats/prod/corona-world-stats.json?ts="+(t=t.getTime()),"worldBtn")}getIndiaData();